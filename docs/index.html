<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Predicting ploidal level from sequence data using site-based heterozygosity • nQuack</title>
<script src="deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="deps/headroom-0.11.0/headroom.min.js"></script><script src="deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="deps/search-1.0.0/fuse.min.js"></script><script src="deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="pkgdown.js"></script><meta property="og:title" content="Predicting ploidal level from sequence data using site-based heterozygosity">
<meta name="description" content="nQuack estimates the most likely ploidal level based on a mixture of models.">
<meta property="og:description" content="nQuack estimates the most likely ploidal level based on a mixture of models.">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YWYQ5CX5NC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YWYQ5CX5NC');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="index.html">nQuack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="articles/BasicExample.html">Basic Example</a></li>
    <li><a class="dropdown-item" href="articles/DataPreparation.html">Data Preparation</a></li>
    <li><a class="dropdown-item" href="articles/FasterExample.html">Faster Example</a></li>
    <li><a class="dropdown-item" href="articles/ModelOptions.html">Model Options</a></li>
    <li><a class="dropdown-item" href="articles/SimulateData.html">Simulate Data</a></li>
    <li><a class="dropdown-item" href="articles/Outliers.html">Outliers</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-home">
<div class="row">
  <main id="main" class="col-md-9"><div class="section level1">
<div class="page-header"><h1 id="nquack">nQuack<a class="anchor" aria-label="anchor" href="#nquack"></a>
</h1></div>
<p><img src="reference/figures/nQuack.png" align="right" width="200"></p>
<p><strong>Michelle L. Gaynor, Jacob B. Landis, Tim K. O’Connor, Robert G. Laport, Jeff J. Doyle, Douglas E. Soltis, José Miguel Ponciano, and Pamela S. Soltis</strong></p>
<p><a href="https://www.gnu.org/licenses/gpl-3.0" class="external-link"><img src="https://img.shields.io/badge/License-GPLv3-blue.svg" alt="License: GPL v3"></a></p>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>nQuack is a modified statistical framework to predict ploidy level based on sequence data. We build upon <a href="https://doi.org/10.1186/s12859-018-2128-z" class="external-link">Weib et al., 2018</a> Gaussian Mixture Model approach to estimate ploidy level, which was originally written as <a href="https://github.com/clwgg/nQuire" class="external-link">a C executable</a>.</p>
</div>
<div class="section level2">
<h2 id="more-on-nquack">More on nQuack<a class="anchor" aria-label="anchor" href="#more-on-nquack"></a>
</h2>
<p>Here we provided expanded tools and implementations to improve site-based heterozygosity inferences of ploidal level.</p>
<p>nQuack provides data preparation guidance and tools to decrease noise in input data. These include a maximum sequence coverage quantile filter and sequence error-based filter, to remove biallelic sites that are likely not representative of copy number variance in the nuclear genome. We also consider only the frequency of allele A or B at each site, instead of both, as found in other methods. To learn more about best practices, see our <a href="https://mlgaynor.com/nQuack/articles/DataPreparation.html" class="external-link">Data Preparation</a> guide.</p>
<p>Our model improves upon the nQuire framework by extending it to higher ploidal levels (pentaploid and hexaploid), correcting the augmented likelihood calculation, implementing more suitable distribution, and allowing additional ‘fixed’ models. We also decrease model selection errors by relying on BIC rather than likelihood ratio tests. To learn more about these methods, see our <a href="https://mlgaynor.com/nQuack/articles/ModelOptions.html" class="external-link">Model Options</a> guide.</p>
<p>We provide 32 ways to estimates likelihood of a mixture of models with the expectation maximization algorithm (<a href="https://mlgaynor.com/nQuack/articles/ModelOptions.html" class="external-link">see more here</a>) - 8 expectation maximization implementations with 4 model types each. In total, nQuack offers 128 models.</p>
</div>
<div class="section level2">
<h2 id="evaluation-of-nquack">Evaluation of nQuack<a class="anchor" aria-label="anchor" href="#evaluation-of-nquack"></a>
</h2>
<p><img src="reference/figures/SummarynQuack.png" align="center"></p>
<p><strong>Figure 1</strong>. Accuracy of nQuire, nQuack’s implementation of nQuire, nQuack’s best model, and a simplified version of nQuack across data sets.</p>
<p>To examine the utility of this method, we examined 513,792 models based on both simulated and real samples. Figure 1 depicts the accuracy of our method across our included data sets. More information on nQuack’s implementation of nQuire can be found on <a href="https://mlgaynor.com/nQuack/articles/ModelOptions.html" class="external-link">our pkgdown site</a> and in the <a href="https://www.doi.org/10.1002/aps3.11606" class="external-link">Appendix S1</a>. In Figure 1, the simplified version of nQuack only classifies samples as diploid or polyploid - though this is not ideal, it is accurate!</p>
<p>Before using this method, we suggest you read our manuscript and consider the many limitations to a pattern-based approach for determining ploidal level.</p>
</div>
<div class="section level2">
<h2 id="installation">Installation<a class="anchor" aria-label="anchor" href="#installation"></a>
</h2>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"mgaynor1/nQuack"</span><span class="op">)</span></span></code></pre>
<div class="section level3">
<h3 id="warning-samtools-must-be-local">Warning: samtools must be local!<a class="anchor" aria-label="anchor" href="#warning-samtools-must-be-local"></a>
</h3>
<p>If you are working on your personal computer, make sure samtools is installed and callable as “samtools” via terminal. If you are working on a cluster, you may need to symbolically-link samtools locally. Though the location of install may differ, here is how I make samtools callable locally on UF’s amazing <a href="https://www.rc.ufl.edu/about/hipergator/" class="external-link">HiPerGator</a> slurm cluster - note, the following should be run in your home directory (i.e., ‘pwd’ = /home/username) :</p>
<pre><code>mkdir bin
cd bin
ln -s /apps/samtools/1.15/bin/samtools samtools</code></pre>
<p>Thanks to <a href="https://github.com/jessiepelosi" class="external-link">jessiepelosi</a>, here is another option:</p>
<pre><code><span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.setenv</a></span><span class="op">(</span>PATH<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"/apps/samtools/1.19.2/bin"</span>, <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"PATH"</span><span class="op">)</span>,sep<span class="op">=</span><span class="st">":"</span><span class="op">)</span><span class="op">)</span></span></code></pre>
<p>For implementation, see our <a href="https://mlgaynor.com/nQuack/articles/BasicExample.html" class="external-link">Basic Example</a> article.</p>
</div>
</div>
<div class="section level2">
<h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<p>Gaynor ML, Landis JB, O’Connor TK, Laport RG, Doyle JJ, Soltis DE, Ponciano JM, and Soltis PS. 2024. nQuack: An R package for predicting ploidy level from sequence data using site-based heterozygosity. <em>Applications in Plant Sciences</em> 12(4):e11606. <a href="https://www.doi.org/10.1002/aps3.11606" class="external-link">doi: 10.1002/aps3.11606</a></p>
</div>
<div class="section level2">
<h2 id="up-next">Up Next:<a class="anchor" aria-label="anchor" href="#up-next"></a>
</h2>
<ul>
<li>If you have sequence data with known plodial level for a mixed-ploidy system, let us know. We would love to collaborate with you. To be included in v2.0, please send me an email at shellyleegaynor at gmail.</li>
</ul>
</div>
</div>
  </main><aside class="col-md-3"><div class="links">
<h2 data-toc-skip>Links</h2>
<ul class="list-unstyled">
<li><a href="https://github.com/mgaynor1/nQuack/" class="external-link">Browse source code</a></li>
<li><a href="https://github.com/mgaynor1/nQuack/issue" class="external-link">Report a bug</a></li>
</ul>
</div>

<div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3" class="external-link">GPL-3</a></li>
</ul>
</div>


<div class="citation">
<h2 data-toc-skip>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html#citation">Citing nQuack</a></li>
</ul>
</div>

<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>ML Gaynor <br><small class="roles"> Maintainer </small>   </li>
</ul>
</div>



  </aside>
</div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by ML Gaynor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
