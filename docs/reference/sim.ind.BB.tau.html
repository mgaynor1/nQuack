<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Simulate Allele Counts for Single Individual - Beta-Binomial Distribution with Overdispersion and Error — sim.ind.BB.tau • nQuack</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Simulate Allele Counts for Single Individual - Beta-Binomial Distribution with Overdispersion and Error — sim.ind.BB.tau"><meta name="description" content="This function is used to simulate the frequency of
biallelic heterozygous sites assuming a beta-binomial distribution. Here we
sample sequence depth from a truncated poisson distribution between a set minimum, maximum,
and lambda. Only heterozygous sites are returned.
Based on input variables, the sites may be filtered based on the total coverage (filter.coverage), allele
sequencing coverage (filter.error), or allele frequency (filter.freq)."><meta property="og:description" content="This function is used to simulate the frequency of
biallelic heterozygous sites assuming a beta-binomial distribution. Here we
sample sequence depth from a truncated poisson distribution between a set minimum, maximum,
and lambda. Only heterozygous sites are returned.
Based on input variables, the sites may be filtered based on the total coverage (filter.coverage), allele
sequencing coverage (filter.error), or allele frequency (filter.freq)."><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-YWYQ5CX5NC"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-YWYQ5CX5NC');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nQuack</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/BasicExample.html">Basic Example</a></li>
    <li><a class="dropdown-item" href="../articles/DataPreparation.html">Data Preparation</a></li>
    <li><a class="dropdown-item" href="../articles/ModelOptions.html">Model Options</a></li>
    <li><a class="dropdown-item" href="../articles/SimulateData.html">Simulate Data</a></li>
    <li><a class="dropdown-item" href="../articles/Outliers.html">Outliers</a></li>
  </ul></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Simulate Allele Counts for Single Individual - Beta-Binomial Distribution with Overdispersion and Error</h1>
      <small class="dont-index">Source: <a href="https://github.com/mgaynor1/nQuack/blob/HEAD/R/sim.ind.BB.tau.R" class="external-link"><code>R/sim.ind.BB.tau.R</code></a></small>
      <div class="d-none name"><code>sim.ind.BB.tau.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function is used to simulate the frequency of
biallelic heterozygous sites assuming a beta-binomial distribution. Here we
sample sequence depth from a truncated poisson distribution between a set minimum, maximum,
and lambda. Only heterozygous sites are returned.
Based on input variables, the sites may be filtered based on the total coverage (<code>filter.coverage</code>), allele
sequencing coverage (<code>filter.error</code>), or allele frequency (<code>filter.freq</code>).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sim.ind.BB.tau</span><span class="op">(</span></span>
<span>  <span class="va">mvec</span>,</span>
<span>  <span class="va">avec</span>,</span>
<span>  tau <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  error <span class="op">=</span> <span class="fl">0.001</span>,</span>
<span>  s.size <span class="op">=</span> <span class="fl">50000</span>,</span>
<span>  lambda <span class="op">=</span> <span class="fl">11</span>,</span>
<span>  max.coverage <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  min.coverage <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  filter.coverage <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  max.depth.quantile.prob <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>  filter.error <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  filter.freq <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  trunc <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span>,</span>
<span>  sampled <span class="op">=</span> <span class="cn">TRUE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-mvec">mvec<a class="anchor" aria-label="anchor" href="#arg-mvec"></a></dt>
<dd><p>Vector of mean values of allele frequency.</p></dd>


<dt id="arg-avec">avec<a class="anchor" aria-label="anchor" href="#arg-avec"></a></dt>
<dd><p>Vector of alpha values representing the proportion expected of each mean.</p></dd>


<dt id="arg-tau">tau<a class="anchor" aria-label="anchor" href="#arg-tau"></a></dt>
<dd><p>Overdispersion parameter. Defaults to 0.01.</p></dd>


<dt id="arg-error">error<a class="anchor" aria-label="anchor" href="#arg-error"></a></dt>
<dd><p>Sequencing error rate. Defaults to 0.001.</p></dd>


<dt id="arg-s-size">s.size<a class="anchor" aria-label="anchor" href="#arg-s-size"></a></dt>
<dd><p>Number of biallelic sites to generate. Defaults to 50000. Warning,
the number of sites generated will not be the number of sites returned
due to filtering steps.</p></dd>


<dt id="arg-lambda">lambda<a class="anchor" aria-label="anchor" href="#arg-lambda"></a></dt>
<dd><p>Set lambda for the truncated poisson distrubtion. Defaults to 11.</p></dd>


<dt id="arg-max-coverage">max.coverage<a class="anchor" aria-label="anchor" href="#arg-max-coverage"></a></dt>
<dd><p>Maximum sequencing depth per site. Defaults to 20.</p></dd>


<dt id="arg-min-coverage">min.coverage<a class="anchor" aria-label="anchor" href="#arg-min-coverage"></a></dt>
<dd><p>Minimum sequencing depth per site. Defaults to 2.</p></dd>


<dt id="arg-filter-coverage">filter.coverage<a class="anchor" aria-label="anchor" href="#arg-filter-coverage"></a></dt>
<dd><p>Default as TRUE. Filters to only retain sites where total sequencing depth
is greater than the provided minimum coverage and less than the max quantile depth (set with the max.depth.quantile.prob).</p></dd>


<dt id="arg-max-depth-quantile-prob">max.depth.quantile.prob<a class="anchor" aria-label="anchor" href="#arg-max-depth-quantile-prob"></a></dt>
<dd><p>Maximum depth quantile probability. Defaults to 0.9.</p></dd>


<dt id="arg-filter-error">filter.error<a class="anchor" aria-label="anchor" href="#arg-filter-error"></a></dt>
<dd><p>Default as TRUE. Filter to only retain sites where allele coverage
is greater than the sequencing error rate times the total coverage, but
less than one minus the sequencing error rate times the total coverage.</p></dd>


<dt id="arg-filter-freq">filter.freq<a class="anchor" aria-label="anchor" href="#arg-filter-freq"></a></dt>
<dd><p>Default as FALSE. When set to true, sites are filtered based on provided <code>trunc</code>.</p></dd>


<dt id="arg-trunc">trunc<a class="anchor" aria-label="anchor" href="#arg-trunc"></a></dt>
<dd><p>List of two values representing the lower and upper bounds, \(c_{L}\) and \(c_{U}\).
Defaults as c(0,0) to represent no truncation.</p></dd>


<dt id="arg-sampled">sampled<a class="anchor" aria-label="anchor" href="#arg-sampled"></a></dt>
<dd><p>Default as TRUE. Will randomly sample allele A or allele B, then return a data
frame with total coverage and coverage of a randomly sampled allele will be returned.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>If sampled = FALSE, a data frame with total coverage, coverage of allele A,
and coverage of allele B will be returned. If sampled = TRUE, a data frame with total coverage
and coverage of a randomly sampled allele will be returned.</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by ML Gaynor.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

